---
import Layout from "../../layouts/Layout.astro";
import SectionTitle from "../../components/ui/SectionTitle.astro";
import Socials from "../../components/Socials.astro";
import BlogGrid from "../../components/blog/BlogGrid.astro";
import Pagination from "../../components/blog/Pagination.astro";
import { getCollection } from "astro:content";
import type { GetStaticPaths, Page } from 'astro';
import type { CollectionEntry } from 'astro:content';

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
    const allPosts = await getCollection("blog");
    const sortedPosts = allPosts.sort(
        (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
    );
    
    return paginate(sortedPosts, { pageSize: 5 });
}

interface Props {
    page: Page<CollectionEntry<'blog'>>;
}

const { page } = Astro.props;
const pageTitle = "Blog - Insights & Articles";
---

<Layout title={pageTitle}>
    <section class="max-w-8xl px-6 lg:px-12">
        <div class="space-y-12">
            <!-- Blog Header -->
            <div class="space-y-6">
                <SectionTitle title="Blog Posts" />
                <p class="text-lg text-zircon-300">
                    Thoughts, insights, and experiences about design and development.
                </p>
            </div>

            <BlogGrid posts={page.data} />
            
            <Pagination 
                currentPage={page.currentPage}
                lastPage={page.lastPage}
                prevUrl={page.url.prev}
                nextUrl={page.url.next}
            />
        </div>
        <Socials />
    </section>
</Layout>